{"ast":null,"code":"import _slicedToArray from\"C:/Users/HP/Desktop/Coding/Projects in progress/FHS/server/website/fhs/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"C:/Users/HP/Desktop/Coding/Projects in progress/FHS/server/website/fhs/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/HP/Desktop/Coding/Projects in progress/FHS/server/website/fhs/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useState}from'react';import axios from'axios';import'./styles.css';import{useParams}from'react-router';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var getPost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(id){var post;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(id);_context.next=3;return axios.post(\"/search\",{_id:id}).then(function(response){return post=response.data;}).catch(function(err){return console.log(err);});case 3:console.log(post);return _context.abrupt(\"return\",post);case 5:case\"end\":return _context.stop();}}},_callee);}));return function getPost(_x){return _ref.apply(this,arguments);};}();var showComments=function showComments(post){var rawComments=post.comments;var comments=[];if(rawComments.length===0){return/*#__PURE__*/_jsx(\"p\",{className:\"post-view-content\",children:\"\\u0644\\u0627 \\u064A\\u0648\\u062C\\u062F \\u062A\\u0639\\u0644\\u064A\\u0642 \\u062D\\u062A\\u0649 \\u0627\\u0644\\u0622\\u0646\"});}else{for(var x=rawComments.length;x>0;x--){comments.push(/*#__PURE__*/_jsx(\"p\",{className:\"comment\",children:rawComments[x-1]}));}}return comments;};var showLikesNumber=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(post){var likes;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.post('/likes',{id:post._id}).then(function(res){return likes=res.data;});case 2:return _context2.abrupt(\"return\",likes);case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function showLikesNumber(_x2){return _ref2.apply(this,arguments);};}();var PostView=function PostView(){var postId=useParams();console.log(postId.id);var _useState=useState(),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),comments=_useState4[0],setComments=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),comment=_useState6[0],setComment=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),reRender=_useState8[0],setReRender=_useState8[1];var _useState9=useState({title:\"إعجاب\",className:\"btn btn-outline-danger\"}),_useState10=_slicedToArray(_useState9,2),likeButton=_useState10[0],setLikeButton=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),likes=_useState12[0],setLikes=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),liked=_useState14[0],setLiked=_useState14[1];if(!post){getPost(postId.id).then(function(res){return setPost(res);});}if(post&&!comments){setComments(showComments(post));}if(!likes&&post){showLikesNumber(post).then(function(res){return setLikes(res);});}console.log(post);var commentChanged=function commentChanged(e){e.preventDefault();setComment(e.target.value);};var submit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return axios.post('/add-comment',{id:post._id,comment:comment});case 2:if(!localStorage.getItem(\"comments\")){localStorage.setItem(\"comments\",[{postId:post._id,comment:comment}]);}else{localStorage.setItem(\"comments\",JSON.stringify(localStorage.getItem(\"comments\").push({postId:post._id,commant:comment})));}setReRender(1);case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function submit(){return _ref3.apply(this,arguments);};}();var addOrRemoveLike=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var likes,x;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:likes=localStorage.getItem('likes');if(!localStorage.getItem('likes')){_context4.next=20;break;}x=0;case 3:if(!(x<likes.length)){_context4.next=13;break;}if(!(post._id===likes[x])){_context4.next=10;break;}localStorage.setItem('likes',likes.splice(x,1));_context4.next=8;return axios.post('/remove-like',{id:post._id});case 8:setReRender(1);return _context4.abrupt(\"return\",null);case 10:x++;_context4.next=3;break;case 13:localStorage.setItem('likes',likes.push(post._id));_context4.next=16;return axios.post('/add-like',{id:post._id});case 16:setReRender(1);return _context4.abrupt(\"return\",null);case 20:localStorage.setItem('likes',[post._id]);_context4.next=23;return axios.post('/add-like',{id:post._id});case 23:return _context4.abrupt(\"return\",null);case 24:case\"end\":return _context4.stop();}}},_callee4);}));return function addOrRemoveLike(){return _ref4.apply(this,arguments);};}();if(post){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h1\",{className:\"post-view-title\",children:post.title}),/*#__PURE__*/_jsx(\"img\",{className:\"post-view-image mx-auto d-block\",src:post.picture}),/*#__PURE__*/_jsxs(\"span\",{className:\"author\",children:[\"\\u0645\\u0646 \",post.author||\"مجهول\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"post-view-content\",children:post.content}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-control\",onChange:commentChanged,placeholder:\"\\u0627\\u062A\\u0631\\u0643 \\u062A\\u0639\\u0644\\u064A\\u0642!\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:submit,children:\"\\u0625\\u0631\\u0633\\u0627\\u0644\"})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h3\",{children:\"\\u0627\\u0644\\u062A\\u0639\\u0644\\u064A\\u0642\\u0627\\u062A:\"}),comments]});}else{return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h1\",{children:\"\\u0644\\u0645 \\u064A\\u062A\\u0645 \\u0625\\u064A\\u062C\\u0627\\u062F \\u0627\\u0644\\u0645\\u0646\\u0634\\u0648\\u0631 \\u0627\\u0644\\u0630\\u064A \\u062A\\u0628\\u062D\\u062B \\u0639\\u0646\\u0647 !\"})]});}};export default PostView;","map":{"version":3,"sources":["C:/Users/HP/Desktop/Coding/Projects in progress/FHS/server/website/fhs/src/components/postView.js"],"names":["React","useState","axios","useParams","getPost","id","console","log","post","_id","then","response","data","catch","err","showComments","rawComments","comments","length","x","push","showLikesNumber","res","likes","PostView","postId","setPost","setComments","comment","setComment","reRender","setReRender","title","className","likeButton","setLikeButton","setLikes","liked","setLiked","commentChanged","e","preventDefault","target","value","submit","localStorage","getItem","setItem","JSON","stringify","commant","addOrRemoveLike","splice","picture","author","content"],"mappings":"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","sourcesContent":["import React, {useState} from 'react';\r\nimport axios from 'axios';\r\nimport './styles.css';\r\nimport { useParams } from 'react-router';\r\n\r\nvar getPost = async(id) => {\r\n    var post;\r\n    console.log(id);\r\n    await axios.post(\"/search\", {_id: id}).then(response => post = response.data).catch(err => console.log(err))\r\n    console.log(post)\r\n    return post;\r\n}\r\nvar showComments = (post) => {\r\n    var rawComments = post.comments;\r\n    var comments = [];\r\n    if(rawComments.length === 0){\r\n        return (<p className=\"post-view-content\">لا يوجد تعليق حتى الآن</p>);\r\n    }\r\n    else{\r\n        for(var x = rawComments.length; x > 0; x--){\r\n            comments.push(<p className=\"comment\">{rawComments[x - 1]}</p>)\r\n        }\r\n    }\r\n    return comments\r\n}\r\n\r\nvar showLikesNumber = async(post) => {\r\n    var likes;\r\n    await axios.post('/likes', {id: post._id}).then(res => likes = res.data);\r\n    return likes;\r\n}\r\n\r\nvar PostView = () => {\r\n    var postId = useParams();\r\n    console.log(postId.id)\r\n    var [post, setPost] = useState();\r\n    var [comments, setComments] = useState();\r\n    var [comment, setComment] = useState();\r\n    var [reRender, setReRender] = useState();\r\n    var [likeButton, setLikeButton] = useState({title: \"إعجاب\", className: \"btn btn-outline-danger\"});\r\n    var [likes, setLikes] = useState();\r\n    var [liked, setLiked] = useState(false);\r\n    if(!post){getPost(postId.id).then(res => setPost(res))}\r\n    if(post && !comments){setComments(showComments(post))}\r\n    if(!likes && post){showLikesNumber(post).then(res => setLikes(res))}\r\n    console.log(post)\r\n\r\n    var commentChanged = (e) => {\r\n        e.preventDefault();\r\n        setComment(e.target.value);\r\n    }\r\n\r\n    var submit = async() => {\r\n        await axios.post('/add-comment', {id: post._id, comment: comment});\r\n        if(!localStorage.getItem(\"comments\")){\r\n            localStorage.setItem(\"comments\", [{postId: post._id, comment: comment}])\r\n        }\r\n        else{\r\n            localStorage.setItem(\"comments\", JSON.stringify(localStorage.getItem(\"comments\").push({postId: post._id, commant: comment})))\r\n        }\r\n        setReRender(1);\r\n    }\r\n\r\n    var addOrRemoveLike = async() => {\r\n        var likes = localStorage.getItem('likes')\r\n        if(localStorage.getItem('likes')){\r\n            for(var x = 0; x < likes.length; x++){\r\n                if(post._id === likes[x]){\r\n                    localStorage.setItem('likes', likes.splice(x, 1));\r\n                    await axios.post('/remove-like', {id: post._id});\r\n                    setReRender(1)\r\n                    return null;\r\n                }\r\n            }\r\n            localStorage.setItem('likes', likes.push(post._id))\r\n            await axios.post('/add-like', {id: post._id});\r\n            setReRender(1)\r\n            return null;\r\n        }else{\r\n            localStorage.setItem('likes', [post._id])\r\n            await axios.post('/add-like', {id: post._id});\r\n            return null;\r\n        }\r\n    }\r\n\r\n    if(post){\r\n        return(\r\n            <div>\r\n                <br />\r\n                <br />\r\n                <h1 className=\"post-view-title\">{post.title}</h1>\r\n                <img className=\"post-view-image mx-auto d-block\" src={post.picture} />\r\n                <span className=\"author\">من {post.author || \"مجهول\"}</span>\r\n                <p className=\"post-view-content\">{post.content}</p>\r\n                <hr />\r\n                <br />\r\n                <br />\r\n                <form>\r\n                    <input className=\"form-control\" onChange={commentChanged} placeholder=\"اترك تعليق!\" />\r\n                    <button className=\"btn btn-primary\" onClick={submit}>إرسال</button>\r\n                </form>\r\n                <br />\r\n\r\n                <h3>التعليقات:</h3>\r\n                {comments}\r\n            </div>\r\n        );\r\n    }\r\n    else{\r\n        return(\r\n            <div>\r\n                <br />\r\n                <br />\r\n                <h1>لم يتم إيجاد المنشور الذي تبحث عنه !</h1>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default PostView;"]},"metadata":{},"sourceType":"module"}